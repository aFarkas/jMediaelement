!function(a){var b=window.webshims&&webshims.$||jQuery;b.jme?a(b):b(window).on("jmepluginready",function(){a(b)})}(function(a){var b='<button class="{%class%}"><span class="jme-icon"></span><span class="jme-text">{%text%}</span></button>',c="pseudoClasses";a.jme.fullscreen=function(){var b,c,d=document.documentElement,e={supportsFullScreen:Modernizr.prefixed("fullscreenEnabled",document,!1)||Modernizr.prefixed("fullScreenEnabled",document,!1),isFullScreen:function(){return!1},requestFullScreen:function(d){var e;b=[],a(d).parentsUntil("body").each(function(){var c,d=a.css(this,"position"),f=this.scrollLeft,g=this.scrollTop;e={elemStyle:this.style,elem:this},"static"!==d&&(c=!0,e.pos=e.elemStyle.position,this.style.position="static"),f&&(c=!0,e.left=f),g&&(c=!0,e.top=g),c&&b.push(e)}),c=!1;try{c={elemStyle:frameElement.style,elem:frameElement,css:{}},c.css.position=c.elemStyle.position,c.elemStyle.position="fixed",a.each(["top","left","right","bottom"],function(a,b){c.css[b]=c.elemStyle[b],c.elemStyle[b]="0px"}),a.each(["height","width"],function(a,b){c.css[b]=c.elemStyle[b],c.elemStyle[b]="100%"})}catch(f){c=!1}e=null},cancelFullScreen:function(){b&&(a.each(b,function(a,b){"pos"in b&&(b.elemStyle.position=b.pos),b.left&&(b.elem.scrollLeft=b.left),b.top&&(b.elem.scrollTop=b.top),b=null}),b=[]),c&&(a.each(c.css,function(a,b){c.elemStyle[a]=b}),c=!1)},eventName:"fullscreenchange",exitName:"exitFullscreen",requestName:"requestFullscreen",elementName:"fullscreenElement",enabledName:""};return e.cancelFullWindow=e.cancelFullScreen,e.requestFullWindow=e.requestFullScreen,e.supportsFullScreen&&(e.enabledName=e.supportsFullScreen,e.exitName=Modernizr.prefixed("exitFullscreen",document,!1)||Modernizr.prefixed("cancelFullScreen",document,!1),e.elementName=Modernizr.prefixed("fullscreenElement",document,!1)||Modernizr.prefixed("fullScreenElement",document,!1),e.supportsFullScreen=!!e.supportsFullScreen,("fullscreenElement"!=e.elementName||"exitFullscreen"!=e.exitName||"fullscreenEnabled"!=e.enabledName)&&a.each(Modernizr._domPrefixes,function(a,b){var c=b+"RequestFullscreen";return c in d||(c=b+"RequestFullScreen")&&c in d?(e.eventName=b+"fullscreenchange",e.requestName=c,!1):void 0}),e.isFullScreen=function(){return document[e.elementName]},e.requestFullScreen=function(a){return a[e.requestName]()},e.cancelFullScreen=function(){return document[e.exitName]()}),window.Modernizr&&"fullscreen"in Modernizr||a("html").addClass(e.supportsFullScreen?"fullscreen":"no-fullscreen"),window.parent!=window&&!function(){try{{var b=window.frameElement;b.style}e.supportsFullScreen&&("allowfullscreen"in b&&!b.allowfullscreen?b.allowfullscreen=!0:(null==b.getAttribute("webkitallowfullscreen")&&b.setAttribute("webkitallowfullscreen",""),null==b.getAttribute("allowfullscreen")&&b.setAttribute("allowfullscreen","allowfullscreen")))}catch(c){e.supportsFullScreen||a("html").addClass("no-fullwindow")}}(),e}(),a.jme.defineProp("fullscreen",{set:function(b,c){var d=a.jme.data(b);if(!(d&&d.player||a(b).hasClass(a.jme.classNS+"player-fullscreen")))return"noDataSet";if(c){if(d.player.hasClass(a.jme.classNS+"player-fullscreen"))return"noDataSet";if(d.scrollPos={top:a(window).scrollTop(),left:a(window).scrollLeft()},a(document).unbind(".jmefullscreen").bind("keydown.jmefullscreen",function(a){return 27==a.keyCode?(d.player.jmeProp("fullscreen",!1),!1):32!==a.keyCode||"form"in a.target?void 0:(d.media.jmeFn("togglePlay"),!1)}),"fullwindow"==c)a.jme.fullscreen.requestFullWindow(d.player[0]);else try{a.jme.fullscreen.requestFullScreen(d.player[0])}catch(e){}a("html").addClass(a.jme.classNS+"has-media-fullscreen"),d.player.addClass(a.jme.classNS+"player-fullscreen"),d.media.addClass(a.jme.classNS+"media-fullscreen"),a(".jme-default-control-bar",d.player).focus(),a.jme.fullscreen.supportsFullScreen&&a(document).bind(a.jme.fullscreen.eventName+".jmefullscreen",function(){var c=a.jme.fullscreen.isFullScreen();c&&b==c?a(b).triggerHandler("playerdimensionchange",["fullscreen"]):d.player.jmeProp("fullscreen",!1)}),d.player.triggerHandler("playerdimensionchange",["fullwindow"])}else{if(d.player&&!d.player.hasClass(a.jme.classNS+"player-fullscreen"))return"noDataSet";if(a(document).unbind(".jmefullscreen"),a("html").removeClass(a.jme.classNS+"has-media-fullscreen"),d.player&&d.media&&(d.player.removeClass(a.jme.classNS+"player-fullscreen"),d.media.removeClass(a.jme.classNS+"media-fullscreen")),a.jme.fullscreen.isFullScreen())try{a.jme.fullscreen.cancelFullScreen()}catch(e){}else a.jme.fullscreen.cancelFullWindow();d.player&&d.player.triggerHandler("playerdimensionchange"),d.scrollPos&&(a(window).scrollTop(d.scrollPos.top),a(window).scrollLeft(d.scrollPos.left),delete d.scrollPos)}return"noDataSet"},get:function(b){var c=a.jme.data(b);if(c&&c.player){var d=c.player.hasClass(a.jme.classNS+"player-fullscreen");return d?a.jme.fullscreen.isFullScreen()||"fullwindow":!1}}}),a.jme.defineProp("autoplayfs"),a.jme.registerPlugin("fullscreen",{pseudoClasses:{enter:"state-enterfullscreen",exit:"state-exitfullscreen"},options:{fullscreen:!0,autoplayfs:!1},structure:b,text:"enter fullscreen / exit fullscreen",_create:function(b,d,e){var f=a.jme.getButtonText(b,[this[c].enter,this[c].exit]),g=function(){f(e.hasClass(a.jme.classNS+"player-fullscreen")?1:0)},h=this.options,i=function(){a(e.data("jme").controlElements).filter(".jme-default-media-overlay").off(".dblfullscreen").on("dblclick.dblfullscreen",function(){e.jmeProp("fullscreen",!e.jmeProp("fullscreen"))})};e.on("controlsadded",i),e.bind("playerdimensionchange",g),b.bind(b.is("select")?"change":"click",function(){var b=e.hasClass(a.jme.classNS+"player-fullscreen")?!1:h.fullscreen;e.jmeProp("fullscreen",b),b&&h.autoplayfs&&d.jmeFn("play")}),i(),g()}})});